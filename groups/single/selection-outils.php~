<?php get_header( 'buddypress' ); ?>

	<script type="text/javascript">
	if ( top.location != self.location ) top.location = self.location.href;
	</script>

	<div id="content">
		<div class="padder">
		
			<?php if ( bp_has_groups() ) : while ( bp_groups() ) : bp_the_group(); ?>

			<?php do_action( 'bp_before_group_home_content' ) ?>

			<div id="item-header" role="complementary">

				<?php locate_template( array( 'groups/single/group-header.php' ), true ); ?>

			</div><!-- #item-header -->

			<div id="item-nav">
				<div class="item-list-tabs no-ajax" id="object-nav" role="navigation">
					<ul>

						<?php bp_get_options_nav(); ?>

						<?php do_action( 'bp_group_options_nav' ); ?><?php do_action( 'bp_group_options_nav' ); ?>
						
					</ul>
				</div>
			</div><!-- #item-nav -->

			<div id="item-body">
				
				<form method="post" action="">

					<h3>Sélection des outils</h3>
					<p>
						<label for="porte-documents">
							<h4>Porte-documents</h4>
							<?php

class Porte_Documents extends BP_Group_Extension {

	function porte_documents() {
		$this->name = 'Porte-documents';
		$this->slug = 'porte-documents';
		$this->create_step_position = 21;
		$this->nav_item_position = 1000;
	}

	/* Vue onglet admin */
	function edit_screen() {
		if ( !bp_is_group_admin_screen( $this->slug ) )
		return false;
		global $wpdb, $bp;
		$id_projet = bp_get_current_group_id();
		$res = $wpdb->get_results("
			SELECT * 
			FROM {$wpdb->prefix}bp_groups 
			WHERE id=".$id_projet."
		") ;

		
		foreach ($res as $meta) {
			if ($meta->porte_documents) {
				?>
				<input type="radio" name="porte-documents" value="1" checked /> Actif
				<?php
			}
			else { 
				?>
				<input type="radio" name="porte-documents" value="0" unchecked /> Inactif
				<?php
			}
			?>
			<p>
				Projet n°<?php echo $id_projet; ?>
			</p>
			
			<p>
				<input type="submit">
			</p>
			<?php
		}
		wp_nonce_field( 'groups_edit_save_' . $this->slug );
		do_action( 'bp_after_group_settings_admin' );
	}

	function edit_screen_save() {
		global $wpdb, $bp;
		if ( !isset( $_POST ) )
		return false;
		check_admin_referer( 'groups_edit_save_' . $this->slug );
		//Insert your edit screen save code here

		//To post an error/success message to the screen, use the following
		if ( !$success )
		bp_core_add_message( __( 'There was an error saving, please try again', 'buddypress' ), 'error' );
		else
		bp_core_add_message( __( 'Settings saved successfully', 'buddypress' ) );
		bp_core_redirect( bp_get_group_permalink( $bp->groups->current_group ) . '/admin/' . $this->slug );
	}
	

	/* Vue onglet principal */
	function display() {
	
		
		
		
		
		
	}
	
}

bp_register_group_extension( 'Porte_Documents' );


?>
						</label>
					</p>
					<p>
						<label for="forum">
							<h4>Forum</h4>
							<input type="radio" name="forum" value="true" />Activer
						</label>
					</p>
				
					<p><input type="submit" class="btn-gray" value="<?php _e( 'Save Changes', 'huddle' ) ?>" id="save" name="save" /></p>

					
				</form>

			</div><!-- #item-body -->

			<?php do_action( 'bp_after_group_home_content' ); ?>

			<?php endwhile; endif; ?>

		</div><!-- .padder -->
	</div><!-- #content -->

<?php get_sidebar( 'buddypress' ); ?>
<?php get_footer( 'buddypress' ); ?>
